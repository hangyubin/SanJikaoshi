import{d as F,r as c,a as f,o as T,c as q,E as A,u as H,b as j,e as s,f as o,w as t,g as a,t as v,h as I,i as J,j as O,k as P,l as m,m as h,_ as Q}from"./index-DxJQWBil.js";import{s as G}from"./axios-B6YHU1xq.js";const K={class:"login-container"},W={class:"login-box"},X={class:"hospital-info"},Y={class:"hospital-logo"},Z={class:"hospital-name"},$={class:"hospital-desc"},ee={class:"hospital-features"},se={class:"feature-item"},oe={class:"feature-item"},te={class:"feature-item"},le={class:"login-form-section"},ae={class:"captcha-container"},ne={class:"captcha-content"},re={class:"form-actions"},ie={class:"register-section"},ce=F({__name:"Login",setup(de){const b=J(),g=c(),d=c(!1),u=f({name:"衡南县第四人民医院",description:"致力于为医务人员提供高质量的三基考试培训",icon:"User"}),l=f({username:"",password:"",code:""}),U=f({username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"用户名长度在 3 到 20 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码长度在 6 到 20 个字符",trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"},{min:4,max:4,message:"验证码长度为 4 个字符",trigger:"blur"}]}),w=c(!1),V=c(""),x=c(""),k=()=>{const n="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let e="";for(let r=0;r<4;r++)e+=n.charAt(Math.floor(Math.random()*n.length));V.value=e,x.value=e},y=()=>{k()};T(()=>{const n=localStorage.getItem("hospitalInfo");if(n){const e=JSON.parse(n);Object.assign(u,e)}k()});const R=q(()=>A[u.icon]||H),M=async()=>{if(g.value)try{if(await g.value.validate(),l.code.toUpperCase()!==x.value){h.error("验证码错误"),y();return}d.value=!0,await G.post("/api/auth/login",{username:l.username,password:l.password}),d.value=!1,h.success("登录成功"),b.push("/dashboard")}catch(n){d.value=!1,console.error("登录失败:",n),h.error(n.response?.data?.message||"登录失败，请稍后重试")}},S=()=>{b.push("/register")};return(n,e)=>{const r=a("el-icon"),B=a("Star"),D=a("Timer"),E=a("Document"),_=a("el-input"),p=a("el-form-item"),L=a("el-checkbox"),N=a("el-link"),C=a("el-button"),z=a("el-form");return I(),j("div",K,[e[13]||(e[13]=s("div",{class:"background-decoration"},[s("div",{class:"circle circle-1"}),s("div",{class:"circle circle-2"}),s("div",{class:"circle circle-3"})],-1)),s("div",W,[s("div",X,[s("div",Y,[o(r,{class:"hospital-icon"},{default:t(()=>[(I(),O(P(R.value)))]),_:1})]),s("h2",Z,v(u.name),1),s("p",$,v(u.description),1),s("div",ee,[s("div",se,[o(r,null,{default:t(()=>[o(B)]),_:1}),e[4]||(e[4]=s("span",null,"专业权威",-1))]),s("div",oe,[o(r,null,{default:t(()=>[o(D)]),_:1}),e[5]||(e[5]=s("span",null,"高效便捷",-1))]),s("div",te,[o(r,null,{default:t(()=>[o(E)]),_:1}),e[6]||(e[6]=s("span",null,"全面覆盖",-1))])])]),s("div",le,[e[12]||(e[12]=s("div",{class:"login-header"},[s("h2",{class:"login-title"},"医疗卫生系统三基考试培训"),s("p",{class:"login-subtitle"},"专业、权威、高效的医务三基考试培训平台")],-1)),o(z,{model:l,rules:U,ref_key:"loginFormRef",ref:g,"label-position":"left","label-width":"80px",class:"login-form"},{default:t(()=>[o(p,{label:"用户名",prop:"username"},{default:t(()=>[o(_,{modelValue:l.username,"onUpdate:modelValue":e[0]||(e[0]=i=>l.username=i),placeholder:"请输入用户名","prefix-icon":"User",size:"large",class:"custom-input"},null,8,["modelValue"])]),_:1}),o(p,{label:"密码",prop:"password"},{default:t(()=>[o(_,{modelValue:l.password,"onUpdate:modelValue":e[1]||(e[1]=i=>l.password=i),type:"password",placeholder:"请输入密码","prefix-icon":"Lock","show-password":"",size:"large",class:"custom-input"},null,8,["modelValue"])]),_:1}),o(p,{label:"验证码",prop:"code"},{default:t(()=>[s("div",ae,[o(_,{modelValue:l.code,"onUpdate:modelValue":e[2]||(e[2]=i=>l.code=i),placeholder:"输入验证码",size:"large",class:"custom-input captcha-input",maxlength:"4"},null,8,["modelValue"]),s("div",{class:"captcha-image",onClick:y},[s("div",ne,v(V.value),1)])])]),_:1}),s("div",re,[o(L,{modelValue:w.value,"onUpdate:modelValue":e[3]||(e[3]=i=>w.value=i),class:"remember-me"},{default:t(()=>[...e[7]||(e[7]=[m("记住我",-1)])]),_:1},8,["modelValue"]),o(N,{type:"primary",underline:!1,class:"forgot-password"},{default:t(()=>[...e[8]||(e[8]=[m("忘记密码？",-1)])]),_:1})]),o(p,null,{default:t(()=>[o(C,{type:"primary",class:"login-btn",onClick:M,loading:d.value,size:"large"},{default:t(()=>[...e[9]||(e[9]=[m(" 登录 ",-1)])]),_:1},8,["loading"])]),_:1}),s("div",ie,[e[11]||(e[11]=s("span",null,"没有账号？",-1)),o(C,{type:"text",onClick:S,class:"register-link"},{default:t(()=>[...e[10]||(e[10]=[m(" 立即注册 ",-1)])]),_:1})])]),_:1},8,["model","rules"])])])])}}}),me=Q(ce,[["__scopeId","data-v-d1854008"]]);export{me as default};
